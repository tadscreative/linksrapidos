<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Ficha CNPJ</title>
  <style>
    .campos-adicionais {
      display: none;
      /* Oculta os campos adicionais por padrão */
    }

    input,
    select {
      border-radius: 2mm;
      margin-bottom: 0, 5mm;
      padding: 1px;
    }
  </style>
</head>

<body>
  <h1>FICHA DE VENDA EMPRESARIAL</h1>
  <div>
    <label for="operadora">#</label>
    <select id="OPERADORA" name="-">
      <option value="manha">OPERADORA CALRO</option>
      <option value="tarde">OPERADORA GIGA+</option>
      <option value="urgente">OPERADORA SKY</option>
    </select><br>
    <form id="ficha-de-venda">
      <label for="name">VENDEDOR:</label>
      <input type="text" id="VENDEDOR" /><br>


      <label for="name">RAZÃO SOCIAL</label>
      <input type="text" id="RAZAO SOCIAL" /><br>

      <label for="cnpj">CNPJ:</label>
      <input type="text" id="cnpj" name="CNPJ" placeholder="00.000.000/0000-00" maxlength="18"
        pattern="\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}" required oninput="mascaraCNPJ(this)"><br>

      <label for="name">SOLICITANTE</label>
      <input type="text" id="SOLICITANTE" /><br>

      <label for="cep">CEP:</label>
      <input type="text" id="cep" name="cep" placeholder="00000-000" maxlength="9" oninput="mascaraCEP(this)"
        onblur="buscarEndereco()"><br>

      <label for="rua">RUA:</label>
      <input type="text" id="rua" name="rua" /><br>

      <label for="numero">NÚMERO:</label>
      <input type="text" id="numero" name="numero" /><br>

      <label for="bairro">BAIRRO:</label>
      <input type="text" id="bairro" name="bairro" /><br>

      <label for="cidade">CIDADE:</label>
      <input type="text" id="cidade" name="cidade" /><br>

      <label for="estado">ESTADO:</label>
      <input type="text" id="estado" name="estado" /><br>

      <label for="referencia">PONTO DE REFERÊNCIA:</label>
      <input type="text" id="referencia" /><br>

      <label for="telefone">TELEFONE:</label>
      <input type="tel" id="telefone" name="telefone" placeholder="(xx) xxxx-xxxx" pattern="\(\d{2}\) \d{4}-\d{4}"
        required><br>

      <label for="whatsapp">TEL COM WHATSAPP:</label>
      <input type="tel" id="whatsapp" name="whatsapp" placeholder="(xx) xxxx-xxxx" pattern="\(\d{2}\) \d{4}-\d{4}"
        required><br>

      <label for="email">E-MAIL:</label>
      <input type="email" id="email" name="email" /><br>

      <label for="responsavel">RESPONSÁVEL PELA INSTALAÇÃO:</label>
      <input type="text" id="responsavel" /><br>

      <label for="data-vencimento">DATA DE VENCIMENTO:</label>
      <input type="text" id="data-vencimento" /><br>

      <label for="periodo-instalacao">PERÍODO DE INSTALAÇÃO:</label>
      <select id="periodo-instalacao" name="periodo-instalacao">
        <option value="manha">Manhã</option>
        <option value="tarde">Tarde</option>
        <option value="urgente">Urgente</option>
      </select><br>

      <label for="forma-pagamento">FORMA DE PAGAMENTO:</label>
      <select id="forma-pagamento" name="forma-pagamento" onchange="toggleCamposAdicionais()">
        <option value="boleto">Boleto</option>
        <option value="debito">Débito</option>
      </select><br>

      <div id="campos-debito" class="campos-adicionais">
        <label for="nome-banco">NOME DO BANCO:</label>
        <input type="text" id="nome-banco" name="nome-banco" /><br>

        <label for="agencia">AGÊNCIA:</label>
        <input type="text" id="agencia" name="agencia" /><br>

        <label for="conta">CONTA:</label>
        <input type="text" id="conta" name="conta" /><br>
      </div>
    </form>

    <!-- Botão para copiar -->
    <button onclick="copiarFormulario()">Copiar Formulário</button>
    <p id="mensagem"></p>
  </div>

  <script>
    // Função para exibir ou ocultar campos adicionais
    function toggleCamposAdicionais() {
      const formaPagamento = document.getElementById('forma-pagamento').value;
      const camposDebito = document.getElementById('campos-debito');

      if (formaPagamento === 'debito') {
        camposDebito.style.display = 'block'; // Mostra os campos de débito
      } else {
        camposDebito.style.display = 'none'; // Oculta os campos de débito
      }
    }

    // Função para copiar todos os dados do formulário dinamicamente
    function copiarFormulario() {
      const formulario = document.getElementById('ficha-de-venda');
      const formaPagamento = document.getElementById('forma-pagamento').value;
      let texto = '';

      // Percorre todos os inputs do formulário
      for (let input of formulario.elements) {
        // Ignora campos de débito se a forma de pagamento for "Boleto"
        if (formaPagamento === 'boleto' && (input.id === 'nome-banco' || input.id === 'agencia' || input.id === 'conta')) {
          continue;
        }

        // Verifica se o campo possui valor e se não é um botão
        if (input.type !== 'button' && input.type !== 'submit' && input.value) {
          if (input.tagName === 'SELECT') {
            // Para campos <select>, adiciona o texto da opção selecionada
            texto += `${input.previousElementSibling.textContent}: ${input.options[input.selectedIndex].text}\n`;
          } else {
            // Para outros tipos de campos
            texto += `${input.previousElementSibling.textContent}: ${input.value}\n`;
          }
        }
      }

      // Copia o texto para a área de transferência
      navigator.clipboard.writeText(texto).then(() => {
        document.getElementById("mensagem").innerText = "Dados copiados com sucesso!";
      }).catch(err => {
        document.getElementById("mensagem").innerText = "Erro ao copiar dados.";
        console.error("Erro ao copiar: ", err);
      });
    }

    // Função para adicionar a máscara de CEP
    function mascaraCEP(campo) {
      campo.value = campo.value.replace(/\D/g, "").replace(/^(\d{5})(\d)/, "$1-$2");
    }

    // Função para buscar o endereço com base no CEP (API ViaCEP)
    function buscarEndereco() {
      const cep = document.getElementById("cep").value.replace("-", "");
      if (cep.length === 8) {
        const url = `https://viacep.com.br/ws/${cep}/json/`;
        fetch(url)
          .then(response => response.json())
          .then(data => {
            if (!data.erro) {
              document.getElementById("rua").value = data.logradouro;
              document.getElementById("bairro").value = data.bairro;
              document.getElementById("cidade").value = data.localidade;
              document.getElementById("estado").value = data.uf;
            } else {
              alert("CEP não encontrado!");
              limparCampos();
            }
          })
          .catch(() => {
            alert("Erro ao buscar o CEP!");
            limparCampos();
          });
      } else {
        alert("CEP inválido!");
        limparCampos();
      }
    }

    // Função para limpar os campos de endereço
    function limparCampos() {
      document.getElementById("rua").value = "";
      document.getElementById("bairro").value = "";
      document.getElementById("cidade").value = "";
      document.getElementById("estado").value = "";
    }
  </script>
</body>

</html>